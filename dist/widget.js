var RAWidget=function(V){"use strict";var te;const ge=`@import"https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Manrope:wght@400;600&display=swap";:host{background:#f5f7fb;display:block}#ra{all:initial;font-family:Inter,Manrope,Segoe UI,sans-serif;font-size:16px;font-weight:400;scroll-margin-top:10%;color:#111827}#ra *{box-sizing:border-box}#ra .box{position:relative;width:min(720px,92%);margin:28px auto;background:#fff;border-radius:10px;border:1px solid #e4e7ec;box-shadow:0 4px 12px #00000014;overflow:hidden}#ra .hd{padding:5px;text-align:center;background:linear-gradient(180deg,#fff,#f8faff);border-bottom:1px solid #eef1f6;border-top-left-radius:10px;border-top-right-radius:10px}#ra .hd p{margin:6px 0 0;color:#6b7280;font-size:14px}#ra .hd p:first-child{margin-top:0}#ra .hd img{width:88px;margin-left:4px;vertical-align:middle}#ra .st{display:none;padding:20px;min-height:420px}#ra .st.on{display:block}#ra .box.small{width:min(420px,92%)}#ra .box.wide{width:min(920px,92%)}#ra #s5{display:none;flex-direction:column;align-items:center;justify-content:flex-start;gap:12px;min-height:200px;padding:30px 20px;text-align:center}#ra #s5.on{display:flex}#ra #s5 .thanks{padding:12px 16px;border-radius:10px;background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0;font-size:16px}#ra #s5 .checkmark{width:48px;height:48px}#ra #s5 .checkmark svg{width:100%;height:100%}#ra #s5 .checkmark svg polyline{stroke:#34d399;stroke-width:4;fill:none;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:50;stroke-dashoffset:50;animation:dash .6s ease forwards}#ra #s5 .note{margin-top:4px;color:#374151;font-size:15px}#ra #s5 #r5{align-self:stretch;text-align:left}@keyframes dash{to{stroke-dashoffset:0}}#ra #s1,#ra #s2{min-height:0;padding-bottom:10px}#ra label{display:block;margin:10px 0 6px;font-size:15px;font-weight:500;color:#111827}#ra input[type=text],#ra input[type=number],#ra select{width:100%;min-height:44px;padding:10px 14px;border:1px solid #d0d5dd;border-radius:8px;background:#fff;color:#0f172a;font-size:16px;line-height:1.4;outline:0;transition:border-color .2s,box-shadow .2s}#ra input:focus,#ra select:focus{border-color:#ff6b00;box-shadow:0 0 0 3px #ff6b0026}#ra select{appearance:none;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="%23ff6b00" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 8.5 12 14.5 18 8.5"/></svg>');background-repeat:no-repeat;background-position:right 14px center;background-size:18px;padding-right:44px}#ra input#n,#ra input#a{background-repeat:no-repeat;background-position:12px center;background-size:18px;padding-left:46px}#ra input#n{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23ff6b00" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21s7-5.25 7-10.5a7 7 0 1 0-14 0C5 15.75 12 21 12 21z"/><circle cx="12" cy="10.5" r="2.5"/></svg>')}#ra input#a{background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="%23ff6b00" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M7 10V8a5 5 0 0 1 10 0v2"/><rect x="5" y="10" width="14" height="11" rx="2"/><path d="M12 14v4"/></svg>')}#ra .row{display:flex;gap:16px}.btns{display:flex;gap:16px;justify-content:space-between;margin-top:16px}.btn{flex:1;display:inline-flex;align-items:center;justify-content:center;gap:10px;min-height:48px;padding:0 18px;border-radius:8px;border:1px solid transparent;cursor:pointer;font-weight:600;font-size:16px;transition:background-color .2s ease,box-shadow .2s ease,transform .2s ease}.p{background:linear-gradient(90deg,#ff6b00,#ff8120);color:#fff;box-shadow:0 8px 18px #ff6b0040}.s{background:#eef2f7;color:#111827}.btn.p{font-weight:700}.btn.p:hover{transform:translateY(-1px);box-shadow:0 10px 20px #ff6b0040}.g{background:#fff8f0;color:#b54708;border:1px solid rgba(255,107,0,.6);border-radius:8px;padding:12px 18px;height:auto;font-weight:600;box-shadow:none;width:100%;justify-content:flex-start;text-align:left}.g:hover{background:#fff2e6;border-color:#ff6b00}.btn .btn-icon{display:inline-flex;align-items:center;justify-content:center}.btn .btn-icon svg{width:18px;height:18px}#ra .progress{width:100%;height:3px;background:#e5e7eb;border-radius:9999px;overflow:hidden}#ra .progress .progress-bar{height:100%;background:#ff6b00;border-radius:9999px;transition:width .3s ease-in-out}.sum{padding:12px 14px;background:linear-gradient(180deg,#fff,#f8faff);border-bottom:1px solid #eef1f6;color:#374151;font-size:14px}.wrap{border:1px solid #e4e7ec;border-radius:10px;overflow:hidden;box-shadow:0 4px 12px #00000014}#ra .info-block,#ra .market-msg{background:#fff8f0;color:#b54708;border:1px solid rgba(255,107,0,.3);border-radius:8px;padding:12px 16px;font-weight:500;font-size:14px;margin:16px 14px 0}#ra .graph-bar-wrapper{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}#ra .graph-bar-wrapper>:last-child{text-align:right}#ra .graph-bar{flex:1;height:8px;background:#e5e7eb;border-radius:9999px;overflow:hidden;margin-right:12px}#ra .graph-bar-fill{height:100%;background:linear-gradient(90deg,#ff6b00,#ff8120);border-radius:9999px;transition:width .3s ease-in-out}#ra .market-bar{flex:1;height:8px;background:#e5e7eb;border-radius:9999px;margin-right:12px;overflow:hidden}#ra .market-bar .bar{height:100%;background:linear-gradient(90deg,#ff6b00,#ff8120);border-radius:9999px;transition:width .3s ease-in-out}.hscroll{overflow-x:auto;-webkit-overflow-scrolling:touch}.hscroll>table{min-width:650px}table{width:100%;border-collapse:separate;border-spacing:0}thead th{background:#fff7f0;color:#7c2d12;border-bottom:1px solid #ffd7ba;padding:10px 12px;font-weight:700;font-size:14px;white-space:nowrap}td{padding:10px 12px;border-bottom:1px solid #f1f5f9;font-size:14px;color:#0f172a;white-space:nowrap}tbody tr:nth-child(2n){background:#fffaf5}tbody tr:first-child{background:#ecfdf5;border-left:4px solid #34d399}tbody tr.first td{padding-top:14px;padding-bottom:14px}tbody tr.ghost td{color:#3b82f6;filter:blur(2px);opacity:.75;font-style:italic}.rc{margin:14px 14px 0}.rc-in{padding:12px}.badgi{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px;font-weight:700;border:1px solid #a7f3d0;background:#ecfdf5;color:#065f46}.obf{filter:blur(4px);display:inline-block}.ibtn{display:inline-block;width:16px;height:16px;line-height:16px;text-align:center;border-radius:50%;background:#7c2d12;color:#fff;font-size:12px;font-weight:700;text-decoration:none;margin-left:4px;position:relative;cursor:pointer}.ibubble{display:none;position:absolute;top:20px;left:0;padding:8px 10px;border:1px solid #ffd7ba;border-radius:8px;background:#fff7f0;color:#7c2d12;max-width:240px;white-space:normal;z-index:20}.ibubble a{color:#3b82f6}.ibubble ul{margin:0;padding-left:16px}.ibtn:hover .ibubble,.ibtn:focus .ibubble{display:block}.consent{display:flex;align-items:flex-start;gap:10px;margin-top:8px;color:#374151;font-size:13px}.fine{margin:10px 0 0;text-align:center;color:#111827;font-size:12px;opacity:.65}.toast{display:none;margin:10px 20px 0;font-size:14px;padding:10px 14px;border-radius:10px}.ok{display:block;background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0}.err{display:block;background:#fef2f2;color:#991b1b;border:1px solid #fecaca}.ctx{margin:-4px 0 10px;color:#6b7280;font-size:13px}.overlay{position:absolute;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;gap:8px;background:#ffffffbf;backdrop-filter:saturate(180%) blur(2px);z-index:10}.overlay .load-msg{color:#111827;font-size:14px;text-align:center;max-width:260px}.box.l .overlay{display:flex}.sp{border:3px solid #eee;border-top:3px solid #ff6b00;border-radius:50%;width:32px;height:32px;animation:spin .6s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width:480px){#ra .box{margin:8px auto;width:min(720px,100%);border-radius:10px}#ra .hd{padding:5px}#ra .st{padding:10px;min-height:440px}#ra input[type=text],#ra input[type=number],#ra select{min-height:40px;padding:9px 12px;font-size:16px}.btn{min-height:46px;font-size:16px}.sum{padding:6px 8px}.rc{margin:4px}.rc-in{padding:6px 8px}.wrap{border-radius:10px}#ra .consent{align-items:center}#ra #s4{padding:6px 10px}#ra #s4 label{margin:6px 0 4px}#ra #s4 .consent{margin-top:6px}#ra #s4 .btns{margin-top:12px}#ra #s4 .fine{margin:8px 0 0}#ra table,#ra input[type=text],#ra input[type=number],#ra select,#ra textarea,#ra .btn{width:100%;margin-left:0;margin-right:0}#ra .btns{flex-direction:column;align-items:center}}`,o=(e,t)=>e.querySelector(t),me=(e,t)=>e.querySelectorAll(t);let u=null;const F=e=>u=e,v=(e,t,a=!1)=>{const n=o(e,"#t");n&&(n.className="toast "+(a?"err":"ok"),n.textContent=t)},K=e=>{const t=o(e,"#t");t&&(t.className="toast",t.textContent="")},j=(e,t)=>{const a=e.querySelector(".box");a&&(t?a.classList.add("l"):a.classList.remove("l"))},W=(e,t,a)=>e.addEventListener("blur",()=>{const n=e.value.trim();if(!n)return;const r=+n;isNaN(r)||(e.value=String(Math.min(Math.max(r,t),a)))}),be=(e,t,a)=>{const n=t.replace(/\D/g,""),r=(a.match(/[9#]/g)||[]).length,s=n.length===r;let i=!0;return e==="+41"&&(i=/^7\d{8}$/.test(n)),{ok:s,mob:i}},he=(e,t)=>{e.innerHTML=t},P=(e,t)=>{j(e,!0),setTimeout(()=>{e.querySelectorAll(".st").forEach(n=>n.classList.remove("on"));const a=o(e,"#s"+t);a&&(a.classList.add("on"),setTimeout(()=>{const n=a.querySelector("input,select,button");n?n.focus({preventScroll:!0}):(a.setAttribute("tabindex","-1"),a.focus()),e&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth",block:"start"})},0)),j(e,!1)},300)},M=async(e,t)=>{try{return j(e,!0),await t()}finally{j(e,!1)}},G=(e,t)=>{const a=o(e,"#ctx");a&&(a.innerHTML=t)},I=e=>e.apiBase||"https://romandeassure.ch/api";async function xe(e,{npa:t,age:a,franchise:n,accident:r}){const i=`${I(e)}/primes?npa=${t}&age=${a}&franchise=${n}&accident=${r}&year=latest&limit=20`,c=e.apiKey?{"X-API-Key":e.apiKey}:{},d=await fetch(i,{headers:c});if(!d.ok)throw new Error("Primes request failed");return d.json()}async function ye(e,{npa:t,age:a,f:n=2500,x:r=0}){const i=`${I(e)}/primes?npa=${t}&age=${a}&franchise=${n}&accident=${r}&year=latest&limit=0`,c=e.apiKey?{"X-API-Key":e.apiKey}:{},d=await fetch(i,{headers:c});if(!d.ok)throw new Error("Meta request failed");return d.json()}async function ve(e,{npa:t,age:a,franchise:n,accident:r}){const i=`${I(e)}/compare?npa=${t}&age=${a}&franchise=${n}&accident=${r}&year=latest`,c=e.apiKey?{"X-API-Key":e.apiKey}:{},d=await fetch(i,{headers:c});return d.ok?d.json():{stats:{},offers:[]}}async function we(e,t){const n=`${I(e)}/register_lead`,r={"Content-Type":"application/json"};e.apiKey&&(r["X-API-Key"]=e.apiKey);try{return(await fetch(n,{method:"POST",headers:r,body:JSON.stringify(t)})).status===200}catch(s){return!1}}const E={VAPID_URL:"/api/push/vapid-public-key",SUB_URL:"/api/push/subscribe",UNSUB_URL:"/api/push/unsubscribe",SW_PATH:"/cus-assets/scripts/sw.js",DEFAULT_TAGS:["primes_2026","lamal"]};function ke(e){const t="=".repeat((4-e.length%4)%4),a=(e+t).replace(/-/g,"+").replace(/_/g,"/"),n=atob(a),r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}async function Ae(){const e=await fetch(E.VAPID_URL,{method:"GET",credentials:"omit"});if(!e.ok)throw new Error("vapid-fetch-failed");const{publicKey:t}=await e.json();if(!t)throw new Error("vapid-missing");return t}async function U(){if(!("serviceWorker"in navigator))throw new Error("sw-unsupported");if(!("PushManager"in window))throw new Error("push-unsupported");const e=await navigator.serviceWorker.register(E.SW_PATH,{scope:"/"});return await Promise.race([navigator.serviceWorker.ready,new Promise((a,n)=>setTimeout(()=>n(new Error("sw-ready-timeout")),5e3))]).catch(()=>e),e}async function $e(){if(!("Notification"in window))throw new Error("notif-unsupported");const e=Notification.permission;if(e==="granted")return"granted";if(e==="denied")throw new Error("blocked-by-user");if(await Notification.requestPermission()!=="granted")throw new Error("user-dismissed-or-blocked");return"granted"}async function J({tags:e=E.DEFAULT_TAGS}={}){var f;const t=await U();await $e();const a=await Ae(),n=ke(a);let r=await t.pushManager.getSubscription();r||(r=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n}));const s=((f=r.toJSON)==null?void 0:f.call(r))||{},i=s&&s.keys||{};if(!i.p256dh||!i.auth)throw new Error("sub-keys-missing");const c={endpoint:r.endpoint,keys:{p256dh:i.p256dh,auth:i.auth},ua:navigator.userAgent,lang:navigator.language||"fr-CH",tags:e},d=await fetch(E.SUB_URL,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"omit",body:JSON.stringify(c)});if(!d.ok)throw new Error("subscribe-api-failed:"+d.status);return!0}async function Se(){const t=await(await U()).pushManager.getSubscription();if(!t)return!0;const a=t.endpoint;return await t.unsubscribe().catch(()=>{}),await fetch(E.UNSUB_URL,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"omit",body:JSON.stringify({endpoint:a})}).catch(()=>{}),!0}async function Z(){try{return!!await(await U()).pushManager.getSubscription()}catch(e){return!1}}async function Ee(){return typeof Notification!="undefined"&&Notification.permission||"default"}function Q(e){const t=e||document,a=Array.from(t.querySelectorAll(".notify-2026"));if(!a.length)return;const n=s=>{s.textContent="✓ Nous vous avertirons dès la sortie des primes 2026",s.disabled=!1,s.classList.add("subscribed")},r=async s=>{s.preventDefault(),a.forEach(i=>i.disabled=!0);try{await J({tags:E.DEFAULT_TAGS}),a.forEach(n)}catch(i){console.error("[push] subscribe error",i);const c=String((i==null?void 0:i.message)||i);c.includes("blocked-by-user")?alert("Notifications bloquées pour ce site. Autorisez-les dans les réglages du navigateur et réessayez."):c.includes("user-dismissed-or-blocked")?alert("Vous devez autoriser les notifications pour les activer."):c.includes("sw-unsupported")||c.includes("push-unsupported")?alert("Votre navigateur ne supporte pas les notifications."):alert("Impossible d’activer les notifications. Réessayez."),a.forEach(d=>d.disabled=!1)}};a.forEach(s=>s.addEventListener("click",r)),Z().then(s=>{s&&a.forEach(n)})}window.RApush={subscribe:J,unsubscribe:Se,isSubscribed:Z,permission:Ee,wireDefaultButton:Q,config:E};const Y=[{code:"+39",mask:"999 999 9999",flag:"🇮🇹",country:"Italy"},{code:"+49",mask:"999 9999999",flag:"🇩🇪",country:"Germany"},{code:"+351",mask:"999 999 999",flag:"🇵🇹",country:"Portugal"},{code:"+33",mask:"9 99 99 99 99",flag:"🇫🇷",country:"France"},{code:"+383",mask:"999 999 999",flag:"🇽🇰",country:"Kosovo"},{code:"+34",mask:"999 99 99 99",flag:"🇪🇸",country:"Spain"},{code:"+90",mask:"999 999 9999",flag:"🇹🇷",country:"Turkey"},{code:"+389",mask:"99 999 999",flag:"🇲🇰",country:"North Macedonia"},{code:"+381",mask:"99 999 9999",flag:"🇷🇸",country:"Serbia"},{code:"+43",mask:"999 9999999",flag:"🇦🇹",country:"Austria"},{code:"+44",mask:"9999 999999",flag:"🇬🇧",country:"United Kingdom"},{code:"+387",mask:"99 999 999",flag:"🇧🇦",country:"Bosnia and Herzegovina"},{code:"+385",mask:"99 999 999",flag:"🇭🇷",country:"Croatia"},{code:"+94",mask:"99 999 9999",flag:"🇱🇰",country:"Sri Lanka"},{code:"+41",mask:"99 999 99 99",flag:"🇨🇭",country:"Switzerland"},{code:"+1",mask:"999-999-9999",flag:"🇺🇸",country:"United States"},{code:"+420",mask:"999 999 999",flag:"🇨🇿",country:"Czech Republic"},{code:"+48",mask:"999 999 999",flag:"🇵🇱",country:"Poland"},{code:"+36",mask:"99 999 9999",flag:"🇭🇺",country:"Hungary"},{code:"+47",mask:"999 99 999",flag:"🇳🇴",country:"Norway"},{code:"+46",mask:"999-999 999",flag:"🇸🇪",country:"Sweden"},{code:"+358",mask:"999 999999",flag:"🇫🇮",country:"Finland"},{code:"+372",mask:"9999 9999",flag:"🇪🇪",country:"Estonia"},{code:"+371",mask:"9999 9999",flag:"🇱🇻",country:"Latvia"},{code:"+370",mask:"999 99999",flag:"🇱🇹",country:"Lithuania"},{code:"+61",mask:"(99) 9999 9999",flag:"🇦🇺",country:"Australia"},{code:"+64",mask:"9999 999 999",flag:"🇳🇿",country:"New Zealand"},{code:"+971",mask:"9 999 9999",flag:"🇦🇪",country:"United Arab Emirates"},{code:"+964",mask:"9999 999 999",flag:"🇮🇶",country:"Iraq"},{code:"+98",mask:"999 9999 9999",flag:"🇮🇷",country:"Iran"},{code:"+961",mask:"## ### ###",flag:"🇱🇧",country:"Lebanon"},{code:"+7",mask:"999 999-99-99",flag:"🇷🇺",country:"Russia"},{code:"+380",mask:"99 999 9999",flag:"🇺🇦",country:"Ukraine"},{code:"+20",mask:"99 999 9999",flag:"🇪🇬",country:"Egypt"},{code:"+212",mask:"5 99 999 999",flag:"🇲🇦",country:"Morocco"},{code:"+213",mask:"5 999 9999",flag:"🇩🇿",country:"Algeria"},{code:"+254",mask:"7 999 999999",flag:"🇰🇪",country:"Kenya"},{code:"+27",mask:"## ### ####",flag:"🇿🇦",country:"South Africa"},{code:"+60",mask:"##-#### ####",flag:"🇲🇾",country:"Malaysia"},{code:"+65",mask:"9999 9999",flag:"🇸🇬",country:"Singapore"},{code:"+91",mask:"99999 99999",flag:"🇮🇳",country:"India"},{code:"+852",mask:"9999 9999",flag:"🇭🇰",country:"Hong Kong"},{code:"+886",mask:"9 9999 9999",flag:"🇹🇼",country:"Taiwan"},{code:"+82",mask:"99-9999-9999",flag:"🇰🇷",country:"South Korea"},{code:"+81",mask:"99-9999-9999",flag:"🇯🇵",country:"Japan"},{code:"+86",mask:"999 9999 9999",flag:"🇨🇳",country:"China"},{code:"+84",mask:"99 999 9999",flag:"🇻🇳",country:"Vietnam"},{code:"+66",mask:"99 999 9999",flag:"🇹🇭",country:"Thailand"},{code:"+62",mask:"89 9999 9999",flag:"🇮🇩",country:"Indonesia"},{code:"+63",mask:"99 999 9999",flag:"🇵🇭",country:"Philippines"},{code:"+54",mask:"99 9999-9999",flag:"🇦🇷",country:"Argentina"},{code:"+55",mask:"(99) 99999-9999",flag:"🇧🇷",country:"Brazil"},{code:"+52",mask:"(99) 9999 9999",flag:"🇲🇽",country:"Mexico"},{code:"+57",mask:"999 999 9999",flag:"🇨🇴",country:"Colombia"},{code:"+58",mask:"9999-999999",flag:"🇻🇪",country:"Venezuela"},{code:"+56",mask:"9 9999 9999",flag:"🇨🇱",country:"Chile"},{code:"+51",mask:"999 999 999",flag:"🇵🇪",country:"Peru"},{code:"+507",mask:"999-9999",flag:"🇵🇦",country:"Panama"},{code:"+502",mask:"9999 9999",flag:"🇬🇹",country:"Guatemala"},{code:"+503",mask:"9999-9999",flag:"🇸🇻",country:"El Salvador"},{code:"+505",mask:"9999 9999",flag:"🇳🇮",country:"Nicaragua"},{code:"+965",mask:"9999 9999",flag:"🇰🇼",country:"Kuwait"},{code:"+966",mask:"9 999 9999",flag:"🇸🇦",country:"Saudi Arabia"},{code:"+974",mask:"9999 9999",flag:"🇶🇦",country:"Qatar"}],_e=Y.map(e=>`<option value="${e.code}" data-mask="${e.mask}"${e.code==="+41"?" selected":""}>${e.flag} ${e.code}</option>`).join(""),ze=((te=Y.find(e=>e.code==="+41"))==null?void 0:te.mask)||"",Pe=`
<div class="box" role="form">
<div class="overlay" aria-hidden="true"><div class="sp" aria-label="Chargement"></div><div class="load-msg">🔎 Analyse de vos offres personnalisées en cours…</div></div>
<div class="hd">
  <p>Comparez gratuitement les meilleures assurances avec <img src="https://romandeassure.ch/cus-assets/images/logo-romandeassure-lamal-compare.webp" alt="RomandeAssure LAMal"></p>
  <p>🚀 Résultats en <strong style="color:#ff6b00">30&nbsp;secondes</strong>!</p>
</div>
<div id="t" class="toast" role="status" aria-live="polite"></div>

<div class="st on" id="s1">
  <div style="margin-bottom:12px">
    <div class="progress"><div class="progress-bar" style="width:25%"></div></div>
    <div style="margin-top:4px;font-size:13px;color:#374151;text-align:right">Étape 1 sur 4</div>
  </div>
  <label for="n">Votre Code postal (NPA)</label><input type="number" id="n" inputmode="numeric" pattern="[0-9]*" min="1000" max="9999" placeholder="Code Postal" required>
  <label for="a">Votre âge</label><input type="number" id="a" inputmode="numeric" pattern="[0-9]*" min="18" max="99" placeholder="Âge" required>
  <button class="btn g notify-2026" data-go="4" data-from2026 style="margin-top:12px">
    <span class="btn-icon" aria-hidden="true">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14.857 17.657A2 2 0 0 1 13 21h-2a2 2 0 0 1-1.857-3.343M18 8a6 6 0 1 0-12 0c0 7-3 9-3 9h18s-3-2-3-9Z" />
      </svg>
    </span>
    Infos sur les primes 2026
  </button>
  <div class="btns"><button class="btn p" data-act="next">Suivant</button></div><p class="fine">Comparaison gratuite – Sans engagement – Réseau de confiance</p>
</div>

<div class="st" id="s2">
  <div style="margin-bottom:12px">
    <div class="progress"><div class="progress-bar" style="width:50%"></div></div>
    <div style="margin-top:4px;font-size:13px;color:#374151;text-align:right">Étape 2 sur 4</div>
  </div>
  <div id="ctx" class="ctx" aria-live="polite"></div>
  <label for="f">Franchise (CHF)</label><select id="f"><option>300</option><option>500</option><option>1000</option><option>1500</option><option>2000</option><option selected>2500</option></select>
  <label for="x">Couverture accident <span class="ibtn" tabindex="0">i<div class="ibubble"><ul><li>Non (par défaut): salarié ≥8h/sem.</li><li>Oui: indépendant, étudiant, retraité, sans emploi, salarié &lt;8h/sem.</li></ul></div></span></label><select id="x"><option value="0" selected>Non</option><option value="1">Oui</option></select>
  <div class="btns"><button class="btn p" data-act="compute">Afficher les résultats</button></div>
</div>

<div class="st" id="s3">
  <div style="margin-bottom:12px">
    <div class="progress"><div class="progress-bar" style="width:75%"></div></div>
  <div style="margin-top:4px;font-size:13px;color:#374151;text-align:right">Étape 3 sur 4</div>
  </div>
  <div id="r"></div>
  <button class="btn g notify-2026" data-go="4" data-from2026 style="margin-top:12px">
    <span class="btn-icon" aria-hidden="true">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14.857 17.657A2 2 0 0 1 13 21h-2a2 2 0 0 1-1.857-3.343M18 8a6 6 0 1 0-12 0c0 7-3 9-3 9h18s-3-2-3-9Z" />
      </svg>
    </span>
    Infos sur les primes 2026
  </button>
  <div class="btns"><button class="btn p" data-go="4">Voir plus d'informations</button></div>
</div>

<div class="st" id="s4">
<!-- K() inyecta aquí el bloque rc (overview mercado) -->

  <div class="rc rc-in" style="margin-top:8px">
    <div style="margin-bottom:12px">
      <div class="progress"><div class="progress-bar" style="width:100%"></div></div>
      <div style="margin-top:4px;font-size:13px;color:#374151;text-align:right">Étape 4 sur 4 – presque terminé 🎉</div>
    </div>
    <div id="s4-msg" style="margin-bottom:8px;color:#111827;font-weight:700">
      Vos offres détaillées sont prêtes ! Débloquez-les immédiatement 👇
    </div>

  <label for="fn">Prénom</label>
  <input type="text" id="fn" placeholder="p. ex. Marie" required>

  <div style="margin-bottom:6px;font-size:13px">📲 Recevez vos offres détaillées immédiatement par WhatsApp ou SMS.</div>
  <div class="row">
    <div style="flex:1">
      <label for="ph_prefix">Code</label>
      <select id="ph_prefix">${_e}</select>
    </div>
    <div style="flex:2">
      <label for="ph">Téléphone</label>
      <input type="text" id="ph" placeholder="${ze}" required>
    </div>
  </div>
  <div class="consent">
    <input type="checkbox" id="wa" checked style="width:18px;height:18px">
      <label for="wa" style="display:flex;align-items:center;gap:6px">
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" style="width:14px;height:14px">
        ✅ Oui, je veux recevoir mes offres détaillées sur WhatsApp.
      </label>
  </div>

  <div class="consent">
    <input id="c" type="checkbox" required style="width:18px;height:18px">
    <label for="c">J’accepte que mes données soient utilisées pour me recontacter*.
      Voir <a href="https://romandeassure.ch/fr/politique-de-confidentialite" target="_blank" rel="noopener noreferrer">Politique de confidentialité</a>.
    </label>
  </div>

  <div class="btns">
        <button class="btn p" data-act="lead" style="flex:2;height:60px;font-size:17px">🔓 Voir mes offres détaillées maintenant</button>
    </div>
  <p style="margin:8px 0 0;text-align:center;color:#374151;font-size:13px">+320 personnes ont trouvé leur assurance idéale cette semaine via RomandeAssure.</p>
  <p class="fine">Comparaison gratuite – Sans engagement – Réseau de confiance</p>
</div>
</div>

<div class="st" id="s5">
  <div class="thanks">Merci beaucoup de vôtre confiance, un agent vous contactera bientôt!</div>
  <div class="checkmark" aria-hidden="true">
    <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12" /></svg>
  </div>
  <div class="note">comme promis, Voici les résultats complets de votre recherche</div>
  <div id="r5"></div>
</div>
</div>
`,O=window.__raSentEvents||new Set;window.__raSentEvents=O;function C(e,t={},a=!0){try{if(!Array.isArray(window.dataLayer)||a&&O.has(e))return;window.dataLayer.push({event:e,...t}),console.log(`RA > ${e} pushed`),a&&O.add(e)}catch(n){console.error("RA > dataLayer push error",n)}}function Ce(e,t={}){var b;he(e,Pe),Q(e),e&&e.scrollIntoView&&e.scrollIntoView({block:"start"});const a=o(e,"#n"),n=o(e,"#a");a&&W(a,1e3,9999),n&&W(n,18,99);const r=o(e,"#ph"),s=o(e,"#ph_prefix"),i=()=>{var y,x,k;if(!r||!s)return;const l=((k=(x=(y=s.selectedOptions)==null?void 0:y[0])==null?void 0:x.dataset)==null?void 0:k.mask)||"",p=r.value.replace(/\D/g,"");let h="",w=0;for(const A of l)if(/[9#]/.test(A))if(p[w])h+=p[w++];else break;else p[w]!==void 0&&(h+=A);r.value=h,r.placeholder=l};r&&s&&(r.addEventListener("input",i),s.addEventListener("change",()=>{r.value="",i()}),i());const c=o(e,'.btn.p[data-act="next"]');c&&c.addEventListener("click",()=>X(e,t));const d=o(e,'.btn.p[data-act="compute"]');d&&d.addEventListener("click",()=>ee(e,t));let f=!1;const m=()=>{const l=o(e,"#info2026"),p=o(e,"#s4 > .wrap.rc"),h=o(e,"#s4 > .market-msg"),w=o(e,"#s4-msg");l&&(l.style.display=f?"block":"none"),p&&(p.style.display=f?"none":"block"),h&&(h.style.display=f?"none":"block"),w&&(w.textContent=f?"Soyez parmi les premiers à recevoir les primes 2026 ! 🎁":"Vos offres détaillées sont prêtes ! Débloquez-les immédiatement 🎁")};(b=me(e,".btn[data-go]"))==null||b.forEach(l=>{const p=l.getAttribute("data-go");p&&l.addEventListener("click",()=>{K(e),p==="4"&&(f=l.hasAttribute("data-from2026"),C("form_step4")),P(e,Number(p)),p==="4"&&m()})}),m();const g=o(e,'.btn.p[data-act="lead"]');g&&g.addEventListener("click",l=>Me(e,l,t)),Object.assign(window,{N:()=>X(e,t),C:()=>ee(e,t),S:l=>{K(e);const h={2:"form_step2",3:"form_step3",4:"form_step4"}[l];h&&C(h),P(e,Number(l))}})}async function X(e,t){var r,s;const a=+(((r=o(e,"#n"))==null?void 0:r.value)||0),n=+(((s=o(e,"#a"))==null?void 0:s.value)||0);if(!a||!n){v(e,"Complétez NPA et Âge.",!0);return}if(a<1e3||a>9999){v(e,"NPA invalide (1000–9999).",!0);return}if(n<18||n>99){v(e,"Âge invalide (18–99).",!0);return}v(e,"OK"),C("form_step2");try{const i=await M(e,()=>ye(t,{npa:a,age:n})),c=(i==null?void 0:i.params)||{};F(c);const d=c.npa_localite||"",f=c.year_resolved||(c.year==="latest"?"dernière année disponible":c.year)||"",m=c.canton_phrase_fr||"",g=m?m.toLowerCase().includes("canton")?m:/^(?:de|du|des|d['’])/i.test(m)?`canton ${m}`:`canton de ${m}`:"",b=c.npa||a;d&&G(e,`Calcul pour <strong>${d}</strong>${g?` <strong>${g}</strong>`:""} (${b}) – année des primes <strong>${f}</strong>.`)}catch(i){}P(e,2)}async function ee(e,t){var x,k,A,N;const a=(x=o(e,"#n"))==null?void 0:x.value,n=(k=o(e,"#a"))==null?void 0:k.value,r=(A=o(e,"#f"))==null?void 0:A.value,s=(N=o(e,"#x"))==null?void 0:N.value;if(!a||!n){v(e,"Complétez NPA et Âge.",!0);return}C("form_step3");let i;try{i=await M(e,()=>xe(t,{npa:a,age:n,franchise:r,accident:s}))}catch($){console.error("RA > primes fetch error",$),v(e,"Erreur lors du calcul des primes.",!0);return}const c=i.rows||[],d=i.params||{};F({...u||{},params:d,rows:c});const f=d.year_resolved||(d.year==="latest"?"dernière année disponible":d.year),m=d.npa_localite||"votre localité",g=d.canton_phrase_fr||"",b=g?g.toLowerCase().includes("canton")?g:/^(?:de|du|des|d['’])/i.test(g)?`canton ${g}`:`canton de ${g}`:"",l=d.npa||a;G(e,`Calcul pour <strong>${m}</strong>${b?` <strong>${b}</strong>`:""} (${l}) – année des primes <strong>${f}</strong>.`);const p=`<div class="sum">Voici <strong>quelques</strong> résultats des primes <strong>${f}</strong> pour une personne de <strong>${n}</strong> ans résidant à <strong>${m}</strong>${b?` <strong>${b}</strong>`:""}, pour une franchise de <strong>CHF ${r}</strong>.</div>`,h=c.slice(0,5).map(($,L)=>{const T=+$.prime,H=T-5.15,B=L?$.insurer:'<span class="obf">Assureur masqué</span>';return`<tr${L?"":' class="first"'}><td>${B}${L?"":'<br/><span class="badgi">Meilleur prix</span>'}</td><td><strong>${H.toFixed(2)}</strong></td><td>${T.toFixed(2)}</td><td>${$.franchise}</td><td>${$.accident?"Oui":"Non"}</td></tr>`}).join(""),y=c.length?`<div class="wrap">
         ${p}
         <div class="hscroll">
           <table aria-label="Résultats des primes" style="text-align:center">
             <thead><tr><th>Assureur</th><th>Prime nette (CHF) <span class="ibtn" tabindex="0">i<div class="ibubble">Du prix de la prime, CHF <strong>5.15</strong> de taxe<br/>environnementale sont déduits. <a href="https://www.parlament.ch/fr/ratsbetrieb/suche-curia-vista/geschaeft?AffairId=20223239" target="_blank" rel="noopener noreferrer">Voir plus</a></div></span></th><th>Prime brutte (CHF)</th><th>Franchise</th><th>Accident</th></tr></thead>
             <tbody>${h}<tr class="ghost"><td colspan="5">Plus de résultats disponibles...</td></tr></tbody>
           </table>
         </div>
       </div>`:`<div class="wrap">${p}<div style="padding:12px 14px;color:#991b1b">Aucun résultat trouvé. Vérifiez le code postal.</div></div>`;o(e,"#r").innerHTML=y,v(e,"Résultats chargés."),P(e,3),await Le(e,t,{npa:a,age:n,franchise:r,accident:s})}async function Le(e,t,a){var r;const n=o(e,"#s4");n==null||n.querySelectorAll(".wrap.rc, #info2026, .market-msg").forEach(s=>s.remove());try{const{offers:s=[],stats:i={}}=await M(e,()=>ve(t,a)),c=(s||[]).slice(0,3).map((w,y)=>{const x=+w.prime-5.15,k=y?w.insurer:'<span class="obf">Nom masqué</span>';return`<li><strong>Top offre ${y+1}:</strong> ${k} – <strong>${x.toFixed(2)} CHF</strong></li>`}).join(""),d=c?`<ul style="margin:0;padding-left:16px;font-size:14px;color:#374151">${c}</ul>`:'<div style="padding:0 0 6px 16px;color:#991b1b">Aucune offre à afficher</div>',f=i.min_prime?i.min_prime-5.15:0,m=i.avg_prime?i.avg_prime-5.15:0,g=i.p50?i.p50-5.15:0,b=Math.max(f,m,g),l=(w,y)=>{if(!y)return"";const x=b?y/b*100:0;return`<div style="display:flex;align-items:center;font-size:12px;margin-top:4px">
          <div style="width:70px;color:#374151">${w}</div>
          <div class="market-bar"><div class="bar" style="width:${x}%"></div></div>
          <div style="width:60px;text-align:right;color:#111827">${y.toFixed(2)} CHF</div>
        </div>`},p=i&&b?`<div style="margin-top:10px">${[l("Min",f),l("Moyenne",m),l("P50",g)].join("")}</div>`:"",h=`
        <div class="wrap rc" style="margin:8px 8px 0 8px;padding:12px">
          <div style="font-weight:700;color:#111827;margin-bottom:8px">Aperçu du marché</div>
          ${d}
          ${p}
        </div>
        <div id="info2026" style="display:none;margin:12px 8px 16px 8px;padding:12px 16px;background:#F9F9F9;border-left:3px solid #FF6B00;color:#333;font-size:14px">
          🔔 Soyez le premier à recevoir les primes 2026<br>👉 Entrez vos coordonnées maintenant pour être averti dès leur publication.
        </div>
        <div class="market-msg" style="margin:0 8px;padding:10px;border:1px dashed #6ee7b7;border-radius:10px;background:#ecfdf5;color:#065f46;font-size:13px">
          <strong>Une fois le formulaire complété</strong>, visualisez gratuitement <strong>ici</strong> toutes vos offres détaillées <strong>par la suite</strong>. 👇
        </div>`;(r=o(e,"#s4"))==null||r.insertAdjacentHTML("afterbegin",h),F({...u||{},compare:{offers:s,stats:i}})}catch(s){}}async function Me(e,t,a){var N,$,L,T,H,B,ae,ne,re,se,ie,oe,ce,de,le,pe,ue,fe;const n=($=(N=o(e,"#fn"))==null?void 0:N.value)==null?void 0:$.trim(),r=(T=(L=o(e,"#ph"))==null?void 0:L.value)==null?void 0:T.trim(),s=((H=o(e,"#ph_prefix"))==null?void 0:H.value)||"",i=((re=(ne=(ae=(B=o(e,"#ph_prefix"))==null?void 0:B.selectedOptions)==null?void 0:ae[0])==null?void 0:ne.dataset)==null?void 0:re.mask)||"",c=(se=o(e,"#c"))==null?void 0:se.checked,d=(ie=o(e,"#wa"))==null?void 0:ie.checked;if(!n){v(e,"Indiquez votre prénom.",!0);return}if(!r){v(e,"Indiquez un numéro de téléphone.",!0);return}const{ok:f,mob:m}=be(s,r,i);if(!f){v(e,"Numéro invalide.",!0);return}if(d&&!m){v(e,"Pour WhatsApp, utilisez un mobile (07X ou +417X).",!0);return}if(!c){v(e,"Vous devez accepter la politique de confidentialité.",!0);return}t&&t.target&&(t.target.disabled=!0);const g=(oe=o(e,"#n"))==null?void 0:oe.value,b=(ce=o(e,"#a"))==null?void 0:ce.value,l=(de=o(e,"#f"))==null?void 0:de.value,p=(le=o(e,"#x"))==null?void 0:le.value,h={npa:g,age:b,franchise:l,accident:p,nom:n,prenom:n,telephone:`${s} ${r}`.trim(),whatsapp:d,consentement:c,data:{npa_localite:(pe=u==null?void 0:u.params)==null?void 0:pe.npa_localite,npa_canton:(ue=u==null?void 0:u.params)==null?void 0:ue.npa_canton,canton_name_fr:(fe=u==null?void 0:u.params)==null?void 0:fe.canton_name_fr,params:{npa:+g,age:+b,franchise:+l,accident:+p}}};if(C("form_lead",{},!1),!await M(e,()=>we(a||{},h))){v(e,"Erreur lors de l'enregistrement.",!0),t&&t.target&&(t.target.disabled=!1);return}C("form_conversion",{value:0,currency:"CHF"}),P(e,5);const y=(u==null?void 0:u.rows)||[],x=(u==null?void 0:u.params)||{},k=o(e,"#r5");if(k&&y.length){x.year_resolved||(x.year==="latest"||x.year),x.npa_localite;const S=x.canton_phrase_fr||"";S&&(S.toLowerCase().includes("canton")||(/^(?:de|du|des|d['’])/i.test(S)?`${S}`:`${S}`));const R=`<div class="wrap"><div class="hscroll"><table aria-label="Résultats des primes" style="text-align:center"><thead><tr><th>Assureur</th><th>Prime nette (CHF) <span class="ibtn" tabindex="0">i<div class="ibubble">Du prix de la prime, CHF <strong>5.15</strong> de taxe<br/>environnementale sont déduits. <a href="https://www.parlament.ch/fr/ratsbetrieb/suche-curia-vista/geschaeft?AffairId=20223239" target="_blank" rel="noopener noreferrer">Voir plus</a></div></span></th><th>Prime brutte (CHF)</th><th>Franchise</th><th>Accident</th></tr></thead><tbody>${y.map(_=>{const q=+_.prime,z=q-5.15;return`<tr><td>${_.insurer}</td><td><strong>${z.toFixed(2)}</strong></td><td>${q.toFixed(2)}</td><td>${_.franchise}</td><td>${_.accident?"Oui":"Non"}</td></tr>`}).join("")}</tbody></table></div></div>`;k.innerHTML=R}const A=o(e,".box");A&&A.classList.add("wide"),setTimeout(async()=>{K(e),e.querySelectorAll("input").forEach(z=>{z.type==="checkbox"?z.checked=!1:z.value=""});const S=o(e,"#f");S&&(S.value="2500");const D=o(e,"#x");D&&(D.value="0");const R=o(e,"#ctx");R&&(R.innerHTML="");const _=o(e,"#r");_&&(_.innerHTML="");const q=o(e,"#r5");q&&(q.innerHTML=""),F(null),t&&t.target&&(t.target.disabled=!1),await M(e,()=>new Promise(z=>setTimeout(z,1e3))),A&&A.classList.remove("wide"),P(e,1)},12e4)}function Ne(e="#ra",t={}){const a=document.querySelector(e);if(!a)throw new Error(`RAWidget: selector not found: ${e}`);const n=a.shadowRoot||a.attachShadow({mode:"open"});let r=n.querySelector("style[data-ra-widget-style]");r||(r=document.createElement("style"),r.setAttribute("data-ra-widget-style",""),r.textContent=ge,n.appendChild(r));let s=n.querySelector("#ra");s||(s=document.createElement("div"),s.id="ra",n.appendChild(s)),Ce(s,t)}return V.init=Ne,Object.defineProperty(V,Symbol.toStringTag,{value:"Module"}),V}({});
